apiVersion: v1
kind: Service
metadata:
  name: securitysvc
  labels:
    app: security-ms
spec:
  ports:
  - port: 3001
    protocol: TCP
    name: http
    targetPort: 3001
  selector:
    app: security-ms
---
apiVersion: v1
kind: ReplicationController
metadata:
  name: security-ms
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: security-ms
    spec:
      containers:
      - name: security-ms
        image: node
        workingDir: /opt/node-app
        command: ["/opt/node-app/docker-entrypoints.sh"]
        env:
        - name: URL
          value: "security-db-mongodb.default.svc.cluster.local"
        - name: XXX_CLIENT_ID_XXX
          value: "xU8HVcRrj0jqgddrmsAsRfoGuVWnOQDCIKcKXr9shdw04f4XEd4whzWJybdQfWG_"
        - name: XXX_CLIENT_SECRET_XXX
          value: "oERrOzvMPokcgFZcEkGUbFLOEuxfctiqaSfXPqMSxhB3QLEa9v58JFfvYnvFWFPT"
        ports:
        - containerPort: 3001
          name: http
        volumeMounts:
        - mountPath: /opt/node-app/
          name: node-app
          subPath: "greenlab/01-Microservices/01-security_microservice"
      volumes:
        - name: node-app
          gitRepo:
            repository: "https://github.com/t5unamie/greenlab.git"
            revision: "cc10a57aabe8fd5d962ba8a64ffb7cfdec6426f1"